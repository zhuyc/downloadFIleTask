!function(){function e(){var e="-40017",t=f.match(/tctravel\/([\d\.]+)/i);return t&&t.length>=2&&(t=t[1].split("."),2==t.length&&t.push(0),3==t.length&&(e=parseInt(t.join("")))),e}function t(){return f.match(/(android)\s+([\d.]+)/)?2:f.match(/(iphone\sos)\s([\d_]+)/)||f.match(/(ipad).*os\s([\d_]+)/)?1:3}function n(){return window.getRefid?window.getRefid():"-40017"}function a(e,t){var n=document.createElement("script");n.type="text/javascript",n.src=e,n.onload=t,document.body.appendChild(n)}function o(e){return e&&-1!==e.indexOf("?")?e.split("?")[0]:e}function r(){return w.slice(0,w.length-1)}function i(e){switch(e=e.toLowerCase()){case"cmwap":case"ctwap":case"ct_w_a_p":case"uniwap":case"unnet":case"uninet":case"3gprs":e="2g";break;case"cmnet":case"ctnet":case"3gwap":case"3gnet":case"my3g":case"cdma":e="3g";break;case"wwan":e="wifi";break;case"ctlte":e="4g";break;case"non_network":case"n":case"mobile":case"internet":case"vpdn":case"ygj":e="other"}return e}function s(){return-1!=document.location.protocol.indexOf("file")?"http://vstlog.17usoft.com/monitor/__h5hm.gif":"//vstlog.17usoft.com/monitor/__h5hm.gif"}function c(){return!E.options.openTest&&b.test(v)?!0:!1}function m(){window.setTimeout(function(){E.setup()},0)}function d(){return{staType:"monitor",project:E.options.project,t_brs:h,pageName:E.options.pageName,platform:E.platform,ptc:r(),mbt:S,rid:T,vsn:x,ext_domain:l,ext_path:g}}function p(e){e=o(e),e=e.split("/");var t=e.length,n=e[t-1];return n||(n=E.options.project+"/"+E.options.pageName),n}function u(){try{var e,t="other";if(window.ActiveXObject)return"IE";if(window.opr&&opr.addons||window.opera||f.indexOf("opr/")>=0)return"opera";for(var n=[{ua:"qqbrowser",name:"qq"},{ua:"qq/",name:"qqclient"},{ua:"baiduboxapp",name:"baiduboxapp"},{ua:"miuibrowser",name:"miuibrowser"},{ua:"firefox",name:"firefox"},{ua:"baidubrowser",name:"baidu"},{ua:"sogoumobilebrowser",name:"sogou"},{ua:"mxios",name:"maxthon"},{ua:"mxbrowser",name:"maxthon"},{ua:"maxthon",name:"maxthon"},{ua:"ucbrowser",name:"UC"},{ua:"liebaofast",name:"liebao"},{ua:"lbbrowser",name:"liebao"},{ua:"qhbrowser",name:"360"},{ua:"360browser",name:"360"},{ua:"360se",name:"360"},{ua:"androidbrowser",name:"androidbrowser"},{ua:"samsung",name:"samsung"},{ua:"huawei",name:"huawei"},{ua:"vivo",name:"vivo"},{ua:"oppo",name:"oppo"},{ua:"micromessenger",name:"micromessenger"},{ua:"chrome",name:"chrome"},{ua:"safari",name:"safari"}],a=0;a<n.length;a++)if(e=n[a],f.indexOf(e.ua)>-1){t=e.name;break}return t}catch(o){return"other"}}var f=window.navigator.userAgent.toLowerCase(),l=encodeURIComponent(document.domain),w=window.location.protocol,g=encodeURIComponent(window.location.pathname.toLowerCase().replace(/\//g,"_")),h=u(),v=document.location.hostname,_="//js.40017.cn/touch/hb/c/2/js/naJs.2.1.2.js",b=/(127[.]0[.]0[.]1)|(localhost)|10(\.([2][0-4]\d|[2][5][0-5]|[01]?\d?\d)){3}|172\.([1][6-9]|[2]\d|3[01])(\.([2][0-4]\d|[2][5][0-5]|[01]?\d?\d)){2}|192\.168(\.([2][0-4]\d|[2][5][0-5]|[01]?\d?\d)){2}/,j=f.indexOf("tctravel")>0,y=f.indexOf("micromessenger")>0,x=e(),S=t(),T=n(),E={options:{url:s(),rate:1,data:{},errStat:0,resTimingStat:0,ajaxTiming:0,pageNameId:"__pageName",projectId:"__projectName",openTest:0,ajaxReqWithOut:4e4},version:"1.3.0",timeLine:"2017.1.20",timing:{},data:{},getPageNameAndProjectName:function(){"use strict";try{var e=document.getElementById(E.options.pageNameId||"__pageName"),t=document.getElementById(E.options.projectId||"__projectName");return e=e&&e.value&&(E.options.pageName=e.value)||E.options.pageName,t=t&&t.value&&(E.options.project=t.value)||E.options.project,{pageName:e,project:t}}catch(n){}},check:function(){var e=this.getPageNameAndProjectName();if(e.project&&e.pageName)return E.options.project=e.project,E.options.pageName=e.pageName,window.performance&&window.performance.timing&&Math.random()<E.options.rate;throw new Error("project或pageName不能为空")},setPlatform:function(){if(E.options.platform)return void(this.platform=E.options.platform);var e=/android/.test(f)||/webos/.test(f)||/iphone/.test(f)||/ipad/.test(f)||/ipod/.test(f)||/blackberry/.test(f)||/windows phone/.test(f)||/meego/.test(f),t=/windows/.test(f)||/mac/.test(f),n=/tctravel/.test(f);y?this.platform="wechat":n?this.platform="app":e?this.platform="touch":t?this.platform="pc":this.platform="other"},merge:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},setup:function(){E.timing=window.performance.timing,E.setData(E.timing)&&E.send(E.data)},getResourceLoadTime:function(){try{var e=[];if("performance"in window&&"getEntriesByType"in window.performance&&window.performance.getEntriesByType("resource")instanceof Array){if(e=window.performance.getEntriesByType("resource"),e.length>0){var t,n,a=[],o=0;if(e.forEach(function(e){t=p(e.name),t&&e.duration>0&&(a.push({perTime:e.duration,perName:t,perType:e.initiatorType||"unknown"}),o+=e.duration)}),a.length>0)return n={resAllTime:o,resCount:a.length,resItem:JSON.stringify(a)}}}else;}catch(r){}},setData:function(e){var t=e.navigationStart||e.fetchStart,n=this,a={t_unload:e.unloadEventEnd-e.unloadEventStart,t_redirect:e.redirectEnd-e.redirectStart,t_dns:e.domainLookupEnd-e.domainLookupStart,t_tcp:e.connectEnd-e.connectStart,t_request:e.responseStart-e.requestStart,t_response:e.responseEnd-e.responseStart,t_paint:E.getFirstPaintTime()-t,t_dom:e.domContentLoadedEventStart-e.domLoading,t_domready:e.domContentLoadedEventStart-t,t_load:e.loadEventStart-e.domLoading,t_onload:e.loadEventStart-t,t_white:e.responseStart-t,t_all:e.loadEventEnd-t};E.options.resTimingStat&&n.getResourceLoadTime()&&E.merge(a,n.getResourceLoadTime());for(var o in a)a.hasOwnProperty(o)&&(a[o]<=0||a[o]>=12e4)&&delete a[o];return E.data=E.merge(a,E.options.data),t>0},getReqServiceName:function(e){var t,n;if("[object Object]"==={}.toString.call(e))n=o(e.servicename||""),t=e.requrl||"",t=o(t);else try{e=JSON.parse(e),n=o(e.servicename||""),t=o(e.requrl||"")}catch(a){}return n||t},processAjax:function(e){var t=this;return function(){var n=[].slice.call(arguments),a=n[0],r=a.beforeSend,i=a.complete,s=a.url,c=a.data||{};return s=o(t.getReqServiceName(c)||s),a.beforeSend=function(){a._ajaxStartTime=+new Date,r&&r.call()},a.complete=function(){var e=[].slice.call(arguments),t=null;if(a._ajaxEndTime=+new Date,a.totalTime=a._ajaxEndTime-a._ajaxStartTime,s&&a.totalTime>0&&a.totalTime<=E.options.ajaxReqWithOut){if(e[0]&&e[0].status)try{t=e[0].status.toString()}catch(n){}var o={interfaceUrl:s.replace(/:/gi,"@"),interfaceTime:a.totalTime,interfaceStatus:t||"-40017"};E.send(o)}i&&i.apply(this,e)},e.apply(this,n)}},rewriteAjax:function(){try{var e,t=this;window.$&&window.$.ajax&&(e=$.ajax,$.ajax=t.processAjax(e)),window.fish&&window.fish.ajax&&(e=fish.ajax,fish.ajax=t.processAjax(e))}catch(n){}},getFirstPaintTime:function(){var e=0;return window.chrome&&"function"==typeof window.chrome.loadTimes?e=1e3*window.chrome.loadTimes().firstPaintTime:"number"==typeof E.timing.msFirstPaint&&(e=E.timing.msFirstPaint),Math.round(e)},send:function(e){var t=E.options.url;if(t){var n,o,r=new Image,s=[],c=d();e=this.merge(c,e||{});for(var m in e)e.hasOwnProperty(m)&&e[m]&&("[object Array]"===Object.prototype.toString.call(e[m])&&(e[m]=JSON.stringify(e[m])),s.push(m+"="+encodeURIComponent(e[m])));if(n=t+(t.indexOf("?")<0?"?":"&")+s.join("&"),j)window._tc_bridge_util?window._tc_bridge_util.get_network_type({param:{},callback:function(e){if(e.CBData){try{o=i(JSON.parse(e.CBData).networkType)}catch(t){o=""}o&&(n+="&networktype="+o),r.src=n+"&rnd="+ +new Date}}}):a(_,function(){window._tc_bridge_util.get_network_type({param:{},callback:function(e){if(e.CBData){try{o=i(JSON.parse(e.CBData).networkType)}catch(t){o=""}o&&(n+="&networktype="+o),r.src=n+"&rnd="+ +new Date}}})});else if(y)try{var p=f.match(/(nettype\/(\w)+)(?=\s)/);p&&p.length>0&&p[0].indexOf("/")>0&&(o=i(p[0].split("/")[1])),o&&(n+="&networktype="+o),r.src=n+"&rnd="+ +new Date}catch(u){}else r.src=n+"&rnd="+ +new Date}},bindEvents:function(){window.onerror=function(e,t,n,a,o){if(t){var r={errFile:p(t).replace(/:/gi,"@")};E.send({errMsg:JSON.stringify(r)})}}},start:function(e){E.options=E.merge(E.options,e),c()||(this.setPlatform(),E.options.errStat&&this.bindEvents(),E.options.ajaxTiming&&this.rewriteAjax(),E.check()?window.performance.timing.loadEventEnd>0?E.setup():window.addEventListener&&window.addEventListener("load",m,!1):E.send())}};window.fedApm=E}();