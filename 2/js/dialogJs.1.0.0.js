define(function(t,e,n){function o(t){this._options={},$.extend(this._options,s),$.extend(this._options,t),this.init()}function i(t){var e,n,o,i=this,a=i._options;switch(t.type){case a.RotateChangeEvent:a._isOpen&&this.refresh();break;case"touchmove":a.scrollMove&&t.preventDefault();break;case"click":if(a._mask&&($.contains(a._mask[0],t.target)||a._mask[0]===t.target))return"function"==typeof a.maskClick&&a.maskClick();if(n=a._wrap.get(0),(e=$(t.target).closest(".close",n))&&e.length)i.close();else if((e=$(t.target).closest(".ui-dialog-btns .ui-btn",n))&&e.length){var s=e.attr("data-key");o=a.buttons[s],"function"!=typeof o&&(o=o.fn),o&&o.call(i,s,a.buttons,arguments)}else a.wrapClickFn&&a.wrapClickFn($(t.target))}}!function(){function t(){var i=e.attr("hl-cls");clearTimeout(n),e.removeClass(i).removeAttr("hl-cls"),e=null,o.off("touchend touchmove touchcancel",t)}var e,n,o=$(document);$.fn.highlight=function(i,a){return this.each(function(){var s=$(this);s.css({"-webkit-tap-highlight-color":"rgba(255,255,255,0)"}).off("touchstart.hl"),i&&s.on("touchstart.hl",function(c){var l;e=a?(l=$(c.target).closest(a,this))&&l.length&&l:s,e&&(e.attr("hl-cls",i),n=setTimeout(function(){e.addClass(i)},100),o.on("touchend touchmove touchcancel",t))})})}}();var a={close:'<a class="close" title="关闭"></a>',mask:'<div class="ui-mask"></div>',title:'<div class="ui-dialog-title"></div>',wrap:'<div class="ui-dialog"><div class="ui-dialog-content"></div></div> '},s={autoOpen:!1,className:"",buttons:null,closeBtn:!1,mask:!0,width:300,height:"auto",title:void 0,content:null,scrollMove:!0,container:null,maskClick:null,beforeOpen:null,afterOpen:null,beforeClose:null,afterClose:null,style:null,closeTime:2e3,className:""};o.prototype.getWrap=function(){return this._options._wrap},o.prototype.init=function(){var t=this,e=t._options;e.eventHand=$.proxy(i,t),e._container=$(e.container||document.body),(e._cIsBody=e._container.is("body"))||e._container.addClass("ui-dialog-container"),e._mask=e.mask?$(a.mask).appendTo(e._container):null,e._wrap=$(a.wrap).appendTo(e._container),e._content=$(".ui-dialog-content",e._wrap),e._title=$(a.title),e._close=e.closeBtn&&$(a.close).appendTo(e._title).highlight("close-hover").on("click",function(){t.close()}),t.title(e.title),t.content(e.content),t.buttons(e.buttons),e._wrap.css({width:e.width,height:e.height}).addClass(e.className),e.RotateChangeEvent="onorientationchange"in window?"orientationchange":"resize",$(window).on(e.RotateChangeEvent,e.eventHand),e._wrap.on("click",e.eventHand),e._mask&&e._mask.on("click",e.eventHand),e.autoOpen&&t.open()},o.prototype.calculate=function(){var t,e,n=this,o=n._options,i=document.body,a={},s=o._cIsBody,c=Math.round;return o.mask&&(a.mask=s?{width:"100%",height:Math.max(i.scrollHeight,i.clientHeight)}:{width:"100%",height:"100%"}),t=o._wrap.offset(),e=$(window),a.wrap={left:"50%",marginLeft:-c(o._wrap.width()/2)+"px",top:s?c(e.height()/2)+window.pageYOffset:"50%",marginTop:-c(o._wrap.height()/2)+"px"},a},o.prototype.refresh=function(){var t,e,n=this,o=n._options;return e=function(){t=n.calculate(),t.mask&&o._mask.css(t.mask),o._wrap.css(t.wrap)},$.os&&$.os.ios&&document.activeElement&&/input|textarea|select/i.test(document.activeElement.tagName)?(document.body.scrollLeft=0,setTimeout(e,200)):setTimeout(e,200),n},o.prototype.open=function(t){var e,n=this._options,o=this;if(!n._isOpen){if(t&&o.content(t),n._isOpen=!0,"tip"==n.style){n.mask&&n._mask.addClass("ui-dialog-tran-03"),n._wrap.addClass("ui-dialog-black");var i=o.getWrap();setTimeout(function(){n.mask&&n._mask.animate({opacity:0},1e3,"ease-out",function(){n._mask.css({opacity:""})}),i.animate({opacity:0},1e3,"ease-out",function(){i.css({opacity:"1"}),o.close()})},n.closeTime)}if("function"==typeof n.beforeOpen&&(e=n.beforeOpen()),e)return this;n._wrap.css({display:"block"}),n._mask&&n._mask.css({display:"block"}),this.refresh(),$(document).on("touchmove",n.eventHand),"function"==typeof n.afterOpen&&n.afterOpen()}},o.prototype.close=function(t){var e=this._options;return"tip"==e.style&&e.mask&&e._mask.removeClass("ui-dialog-tran-03"),"function"==typeof e.beforeClose&&e.beforeClose(),e._isOpen=!1,e._wrap.css({display:"none"}),t?this:(e._mask&&e._mask.css({display:"none"}),$(document).off("touchmove",e.eventHand),"function"==typeof e.afterClose&&e.afterClose(this),this)},o.prototype.title=function(t){var e=this._options,n=void 0!==t;return n&&(t=(e.title=t)?"<h3>"+t+"</h3>":t,e._title.html(t)[t?"prependTo":"remove"](e._wrap),e._close&&e._close.prependTo(e.title?e._title:e._wrap)),n?this:e.title},o.prototype.buttons=function(t,e){if(t){var n=this,o=n._options,i=[],a=0;if(e&&o.buttons)return void $.each(t,function(e){o.buttons[e]=t[e]});if(t&&$.each(t,function(t){i.push({index:++a,text:t,key:t})}),i[0]){for(var s="",a=0,c=i.length;c>a;a++){var l=i[a];s+='<a class="ui-btn ui-btn-'+a+'" data-key="'+l.key+'">'+l.text+"</a>"}o._button&&o._button[0]||(o._button=$('<div class="ui-dialog-btns"></div>').appendTo(o._wrap)),o._button.html(s),$(".ui-btn",o._button).highlight("ui-state-hover"),o.buttons=t}else o._button.remove(),delete o._button,delete o.buttons}},o.prototype.content=function(t){var e=this._options,n=void 0!==t;return n&&e._content.empty().append(e.content=t),n?this:e.content},o.prototype.destroy=function(){var t=this._options;return $(window).off(t.RotateChangeEvent,t.eventHand),$(document).off("touchmove",t.eventHand),t._wrap.off("click",t.eventHand).remove(),t._mask&&t._mask.off("click",t.eventHand).remove(),t._close&&t._close.highlight(),this},$.dialog=function(t){return new o(t)},function(){function t(t,e){var n={autoOpen:!0,closeBtn:!1,style:"tip",mask:e,closeTime:1e3,width:"auto",content:'<p style="">'+t+"</p>"};return $.dialog(n)}function e(e,i){i?"object"==typeof o?o.open(e):o=t(e,!0):"object"==typeof n?n.open(e):n=t(e,!1)}var n,o;$.tips=e}(),function(){var t,n,o=[],i=0,a=function(e,a){this.close(),e&&a&&n(t.param,{tagname:a[e].tagname}),i=0,o.length&&setTimeout(function(){_tc_bridge_util.show_tips_dialog(o[0]),o.shift()},300)};e.dialog=function(e,s){if(1===i)return void o.push(e);n=s;var c={content:'<p style="text-align:center;margin: 0;">'+e.param.desc+"</p>"},l={"确定":function(){a.call(this)}},r=e.param.btnList;if(r&&r.length){l={};for(var u=0;u<r.length;u++)l[r[u].showText]={fn:a,tagname:r[u].tagname}}c.buttons=l,t?(t.content(c.content),t.buttons(c.buttons)):t=$.dialog(c),t.open(),i=1,t.param=e}}()});